e_charts(x = date) |>
e_line(serie = {index_name[1]}) |>
e_line(serie = {index_name[2]}, x_index = 1, y_index = 1) |>
e_theme("dark") |>
e_datazoom(type = "slider") |>
e_tooltip(trigger = "axis") |>
e_title(country)
}
country_plot_(data = df)
country_plot_ <- function(data , index_name = c("Customer Price Index","Unemployment"),
country = "Turkey"){
data |>
filter(index_names %in% index_name & country_name == country) |>
pivot_wider(names_from = index,values_from = rate) |>
clean_names() |>
e_charts(x = date) |>
e_line(serie = {{index_name[1]}}) |>
e_line(serie = {{index_name[2]}}, x_index = 1, y_index = 1) |>
e_theme("dark") |>
e_datazoom(type = "slider") |>
e_tooltip(trigger = "axis") |>
e_title(country)
}
country_plot_(data = df)
bquote(index_name[1])
!bquote(index_name[1])
deparse(substitute(index_name[1]))
country_plot_ <- function(data , index_name = c("Customer Price Index","Unemployment"),
country = "Turkey"){
data |>
filter(index_names %in% index_name & country_name == country) |>
pivot_wider(names_from = index,values_from = rate) |>
clean_names() |>
e_charts(x = date) |>
e_line(serie = {index_name[[1]]}) |>
e_line(serie = {index_name[[2]]}, x_index = 1, y_index = 1) |>
e_theme("dark") |>
e_datazoom(type = "slider") |>
e_tooltip(trigger = "axis") |>
e_title(country)
}
country_plot_(data = df)
country_plot_ <- function(data , index_name = c("Customer Price Index","Unemployment"),
country = "Turkey"){
data |>
filter(index_names %in% index_name & country_name == country) |>
pivot_wider(names_from = index,values_from = rate) |>
clean_names() |>
e_charts(x = date) |>
e_line(serie = index_name[[1]]) |>
e_line(serie = index_name[[2]], x_index = 1, y_index = 1) |>
e_theme("dark") |>
e_datazoom(type = "slider") |>
e_tooltip(trigger = "axis") |>
e_title(country)
}
country_plot_(data = df)
x <- substitute(index_name[1])
x
x <- sym(index_name[1])
x
x <- sym(index_name[1] |>  gsub(" ", "_") |>  tolower())
x
x <- sym(index_name[1] |>  gsub(.," ", "_") |>  tolower())
x <- sym(tolower(gsub(index_name[1]," ","_")))
x
x <- sym(tolower(gsub(" ","_",index_name[1])))
x
y <- sym(tolower(gsub(" ","_",index_name[2])))
y
country_plot_ <- function(data , index_name = c("Customer Price Index","Unemployment"),
country = "Turkey"){
x <- sym(tolower(gsub(" ","_",index_name[1])))
y <- sym(tolower(gsub(" ","_",index_name[2])))
data |>
filter(index_names %in% index_name & country_name == country) |>
pivot_wider(names_from = index,values_from = rate) |>
clean_names() |>
e_charts(x = date) |>
e_line(serie = .index_name[[1]]) |>
e_line(serie = .index_name[[2]], x_index = 1, y_index = 1) |>
e_theme("dark") |>
e_datazoom(type = "slider") |>
e_tooltip(trigger = "axis") |>
e_title(country)
}
country_plot_(data = df)
country_plot_ <- function(data , index_name = c("Customer Price Index","Unemployment"),
country = "Turkey"){
x <- sym(tolower(gsub(" ","_",index_name[1])))
y <- sym(tolower(gsub(" ","_",index_name[2])))
data |>
filter(index_names %in% index_name & country_name == country) |>
pivot_wider(names_from = index,values_from = rate) |>
clean_names() |>
e_charts(x = date) |>
e_line(serie = x) |>
e_line(serie = y, x_index = 1, y_index = 1) |>
e_theme("dark") |>
e_datazoom(type = "slider") |>
e_tooltip(trigger = "axis") |>
e_title(country)
}
country_plot_(data = df)
country_plot_ <- function(data , index_name = c("Customer Price Index","Unemployment"),
country = "Turkey"){
data |>
filter(index_names %in% index_name & country_name == country) |>
pivot_wider(names_from = index,values_from = rate) |>
clean_names() |>
rename(sym(index_name[1]) = index_name[1],
country_plot_ <- function(data , index_name = c("Customer Price Index","Unemployment"),
country = "Turkey"){
data |>
filter(index_names %in% index_name & country_name == country) |>
pivot_wider(names_from = index,values_from = rate) |>
clean_names() |>
rename(  index_name[1] = sym(index_name[1]),
country_plot_ <- function(data , index_name = c("Customer Price Index","Unemployment"),
country = "Turkey"){
data |>
filter(index_names %in% index_name & country_name == country) |>
pivot_wider(names_from = index,values_from = rate) |>
e_charts_(x = date) |>
e_line_(serie = index_name[1]) |>
e_line_(serie = index_name[2], x_index = 1, y_index = 1) |>
e_theme("dark") |>
e_datazoom(type = "slider") |>
e_tooltip(trigger = "axis") |>
e_title(country)
}
country_plot_(data = df)
country_plot_ <- function(data , index_name = c("Customer Price Index","Unemployment"),
country = "Turkey"){
data |>
filter(index_names %in% index_name & country_name == country) |>
pivot_wider(names_from = index,values_from = rate) |>
e_charts_(x = date) |>
e_line_(serie = index_name[1]) |>
e_line_(serie = index_name[2], x_index = 1, y_index = 1) |>
e_theme("dark") |>
e_datazoom(type = "slider") |>
e_tooltip(trigger = "axis") |>
e_title(country)
}
country_plot_(data = df)
country_plot_ <- function(data , index_name = c("Customer Price Index","Unemployment"),
country = "Turkey"){
data |>
filter(index_names %in% index_name & country_name == country) |>
pivot_wider(names_from = index,values_from = rate) |>
e_charts(x = date) |>
e_line_(serie = index_name[1]) |>
e_line_(serie = index_name[2], x_index = 1, y_index = 1) |>
e_theme("dark") |>
e_datazoom(type = "slider") |>
e_tooltip(trigger = "axis") |>
e_title(country)
}
country_plot_(data = df)
country_plot_ <- function(data , index_name = c("Customer Price Index","Unemployment"),
country = "Turkey"){
data |>
filter(index_names %in% index_name & country_name == country) |>
pivot_wider(names_from = index,values_from = rate) |>
e_charts_(x = date) |>
e_line_(serie = index_name[1]) |>
e_line_(serie = index_name[2], x_index = 1, y_index = 1) |>
e_theme("dark") |>
e_datazoom(type = "slider") |>
e_tooltip(trigger = "axis") |>
e_title(country)
}
country_plot_(data = df)
country_plot_ <- function(data , index_name = c("Customer Price Index","Unemployment"),
country = "Turkey"){
plot <- data |>
filter(index_names %in% index_name & country_name == country) |>
pivot_wider(names_from = index,values_from = rate) |>
e_charts_(x = date) |>
e_line_(serie = index_name[1]) |>
e_line_(serie = index_name[2], x_index = 1, y_index = 1) |>
e_theme("dark") |>
e_datazoom(type = "slider") |>
e_tooltip(trigger = "axis") |>
e_title(country)
return(plot)
}
country_plot_(data = df)
df |>
filter(index_names %in% c("Customer Price Index","Unemployment") &
country_name == "Turkey") |>
e_charts_(x = date)
df |>
filter(index_names %in% c("Customer Price Index","Unemployment") &
country_name == "Turkey")
df |>
filter(index_names %in% c("Customer Price Index","Unemployment") &
country_name == "Turkey") |>
pivot_wider(names_from = index,values_from = rate)
df |>
filter(index_names %in% c("Customer Price Index","Unemployment") &
country_name == "Turkey") |>
pivot_wider(names_from = index,values_from = rate) |>
e_charts_(x = date)
df |>
filter(index_names %in% c("Customer Price Index","Unemployment") &
country_name == "Turkey") |>
pivot_wider(names_from = index,values_from = rate) |>
e_charts(x = date)
df |>
filter(index_names %in% c("Customer Price Index","Unemployment") &
country_name == "Turkey") |>
pivot_wider(names_from = index,values_from = rate) |>
e_charts(x = date) |>
e_line_(serie = index_name[1])
df |>
filter(index_names %in% c("Customer Price Index","Unemployment") &
country_name == "Turkey") |>
pivot_wider(names_from = index,values_from = rate)
df |> glimpse()
df |>
filter(index_names %in% c("Customer Price Index","Unemployment") &
country_name == "Turkey") |>
pivot_wider(names_from = index_names,values_from = rate) |>
e_charts(x = date) |>
e_line_(serie = index_name[1])
df |>
filter(index_names %in% c("Customer Price Index","Unemployment") &
country_name == "Turkey") |>
pivot_wider(names_from = index_names,values_from = rate) |>
e_charts(x = date) |>
e_line_(serie = index_name[1]) |>
e_line_(serie = index_name[2])
df |>
filter(index_names %in% c("Customer Price Index","Unemployment") &
country_name == "Turkey") |>
pivot_wider(names_from = index_names,values_from = rate) |>
e_charts(x = date) |>
e_line_(serie = index_name[1]) |>
e_line_(serie = index_name[2], x_index = 1, y_index = 1)
country_plot_ <- function(data , index_name = c("Customer Price Index","Unemployment"),
country = "Turkey"){
data |>
filter(index_names %in% index_name & country_name == country) |>
pivot_wider(names_from = index_names,values_from = rate) |>
e_charts_(x = date) |>
e_line_(serie = index_name[1]) |>
e_line_(serie = index_name[2], x_index = 1, y_index = 1) |>
e_theme("dark") |>
e_datazoom(type = "slider") |>
e_tooltip(trigger = "axis") |>
e_title(country)
}
df |>
filter(index_names %in% c("Customer Price Index","Unemployment") &
country_name == "Turkey") |>
pivot_wider(names_from = index_names,values_from = rate) |>
e_charts_(x = date) |>
e_line_(serie = index_name[1]) |>
e_line_(serie = index_name[2], x_index = 1, y_index = 1)
df |>
filter(index_names %in% c("Customer Price Index","Unemployment") &
country_name == "Turkey") |>
pivot_wider(names_from = index_names,values_from = rate) |>
e_charts(x = date) |>
e_line_(serie = index_name[1]) |>
e_line_(serie = index_name[2], x_index = 1, y_index = 1)
country_plot_ <- function(data , index_name = c("Customer Price Index","Unemployment"),
country = "Turkey"){
data |>
filter(index_names %in% index_name & country_name == country) |>
pivot_wider(names_from = index_names,values_from = rate) |>
e_charts_(x = date) |>
e_line_(serie = index_name[1]) |>
e_line_(serie = index_name[2], x_index = 1, y_index = 1) |>
e_theme("dark") |>
e_datazoom(type = "slider") |>
e_tooltip(trigger = "axis") |>
e_title(country)
}
country_plot_(data = df)
country_plot_ <- function(data , index_name = c("Customer Price Index","Unemployment"),
country = "Turkey"){
data |>
filter(index_names %in% index_name & country_name == country) |>
pivot_wider(names_from = index_names,values_from = rate) |>
e_charts(x = date) |>
e_line_(serie = index_name[1]) |>
e_line_(serie = index_name[2], x_index = 1, y_index = 1) |>
e_theme("dark") |>
e_datazoom(type = "slider") |>
e_tooltip(trigger = "axis") |>
e_title(country)
}
country_plot_(data = df)
index_name
index_names
country_plot_ <- function(data ,
index_name = c("Real imports of goods and services","Real exports of goods and services"),
country = "Turkey"){
data |>
filter(index_names %in% index_name & country_name == country) |>
pivot_wider(names_from = index_names,values_from = rate) |>
e_charts(x = date) |>
e_line_(serie = index_name[1]) |>
e_line_(serie = index_name[2], x_index = 1, y_index = 1) |>
e_theme("dark") |>
e_datazoom(type = "slider") |>
e_tooltip(trigger = "axis") |>
e_title(country)
}
country_plot_(data = df)
index_plot <- function(data ,
index_name = c("Real imports of goods and services","Real exports of goods and services"),
country = "Turkey"){
data |>
filter(index_names %in% index_name & country_name == country) |>
pivot_wider(names_from = index_names,values_from = rate) |>
e_charts(x = date) |>
e_line_(serie = index_name[1]) |>
e_line_(serie = index_name[2], x_index = 1, y_index = 1) |>
e_theme("dark") |>
e_datazoom(type = "slider") |>
e_tooltip(trigger = "axis") |>
e_title(country)
}
runApp()
box::use(
app/logic/plot_func[index_plot],
app/logic/data_list
)
box::use(
shiny[moduleServer, NS,tagList,selectizeInput,fluidPage],
echarts4r[echarts4rOutput,renderEcharts4r],
)
#' @export
ui <- function(id) {
ns <- NS(id)
fluidPage(
selectizeInput(inputId = ns("select_index"),
label = "Select Index",
choices = data_list$index_names,
selected = c("Real imports of goods and services","Real exports of goods and services"),
multiple = TRUE,
options = list(maxItems = 2,minItems =2)),
selectizeInput(inputId = ns("select_country"),
label = "Select Country",
choices = data_list$country_names_,
selected = "Turkey",
multiple = FALSE),
echarts4rOutput(ns("plot_country"))
)
}
#' @export
server <- function(id,df) {
moduleServer(id,  function(input, output, session) {
output$plot_country <- renderEcharts4r({index_plot(data = df(),
index_name = input$select_index,
country = input$select_country)})
})
}
runApp()
box::use(
shiny[fluidPage, moduleServer, NS,reactiveFileReader,bindCache,
fluidRow,column,br,tabsetPanel,tabPanel],
readr[read_rds],
)
box::use(
app/logic/get_data[load_data],
app/view/plot_country,
)
#' @export
ui <- function(id) {
ns <- NS(id)
fluidPage(
tabsetPanel(id = "tabs",type = "pills",
tabPanel(title = "Index",plot_country$ui(ns("plot_country"))),
tabPanel(title = "Country", plot_index$ui(ns("plot_index"))))
)
}
#' @export
server <- function(id) {
moduleServer(id, function(input, output, session) {
df <- reactiveFileReader(86400000,session, "app/logic/df.rds",read_rds)
plot_country$server("plot_country", df)
plot_index$server("plot_index",df)
})
}
box::use(
app/logic/plot_func[index_plot],
app/logic/data_list
)
box::use(
shiny[moduleServer, NS,tagList,selectizeInput,fluidPage],
echarts4r[echarts4rOutput,renderEcharts4r],
)
#' @export
ui <- function(id) {
ns <- NS(id)
fluidPage(
selectizeInput(inputId = ns("select_index"),
label = "Select Index",
choices = data_list$index_names,
selected = c("Real imports of goods and services","Real exports of goods and services"),
multiple = TRUE,
options = list(maxItems = 2,minItems =2)),
selectizeInput(inputId = ns("select_country"),
label = "Select Country",
choices = data_list$country_names_,
selected = "Turkey",
multiple = FALSE),
echarts4rOutput(ns("plot_index"))
)
}
#' @export
server <- function(id,df) {
moduleServer(id,  function(input, output, session) {
output$plot_index <- renderEcharts4r({index_plot(data = df(),
index_name = input$select_index,
country = input$select_country)})
})
}
runApp()
df |> glimpse()
df |>
filter(index_name == "Population" & country_name == " Turkey") |>
e_charts(x = date) |>
e_bar(rate)
df |>
filter(index_names == "Population" & country_name == " Turkey") |>
e_charts(x = date) |>
e_bar(rate)
df |>
filter(index_names == "Population" & country_name == " Turkey")
View(df)
df |>
filter(index_names == "Population" & country_name == " Turkey")
index_name
index_names
df |>
filter(index_names == "Population" & country_name == "Turkey") |>
e_charts(x = date) |>
e_bar(rate)
df |>
filter(index_names == "Population" & country_name %in% c("Turkey","Japan")) |>
e_charts(x = date) |>
e_bar(rate)
df |>
filter(index_names == "Population" & country_name %in% c("Turkey","Japan")) |>
group_by(country_name) |>
e_charts(x = date) |>
e_bar(rate)
df |>
filter(index_names == "Population" & country_name %in% c("Turkey","Japan")) |>
group_by(country_name) |>
e_charts(x = date) |>
e_bar(rate,stack = "grp")
df |>
filter(index_names == "Population" & country_name %in% c("Turkey","Japan")) |>
group_by(country_name) |>
e_charts(x = date,stack = "grp") |>
e_bar(rate)
df |>
filter(index_names == "Population" & country_name == "Turkey") |>
group_by(country_name) |>
e_charts(x = date,stack = "grp") |>
e_bar(rate)
df |>
filter(index_names == "Population" & country_name == "Turkey") |>
group_by(country_name) |>
e_charts(x = date,stack = "grp") |>
e_area(rate)
df |>
filter(index_names == "Population" & country_name == c("Turkey", "Japan")) |>
group_by(country_name) |>
e_charts(x = date,stack = "grp") |>
e_area(rate)
df |>
filter(index_names == "Population" & country_name == c("Turkey", "Japan")) |>
pivot_wider(names_from = index_names,values_from = rate) |>
e_charts(x = date) |>
e_area(date) |>
e_line_(serie = country_name[1]) |>
e_line_(serie = country_name[2], x_index = 1, y_index = 1)
df |>
filter(index_names == "Population" & country_name %in% c("Turkey", "Japan")) |>
pivot_wider(names_from = index_names,values_from = rate) |>
e_charts(x = date) |>
e_area(date) |>
e_line_(serie = country_name[1]) |>
e_line_(serie = country_name[2], x_index = 1, y_index = 1)
df |>
filter(index_names == "Population" & country_name %in% c("Turkey", "Japan")) |>
pivot_wider(names_from = index_names,values_from = rate) |>
e_charts(x = date) |>
e_area(date) |>
e_line_(serie = country_name[1]) |>
e_line_(serie = country_name[2], x_index = 1, y_index = 1)
df |>
filter(index_names == "Population" & country_name %in% c("Turkey", "Japan")) |>
pivot_wider(names_from = index_names,values_from = rate) |>
e_charts(x = date) |>
e_area_(serie = country_name[1]) |>
e_area_(serie = country_name[2], x_index = 1, y_index = 1)
df |>
filter(index_names == "Population" & country_name %in% c("Turkey", "Japan")) |>
pivot_wider(names_from = country_name,values_from = rate) |>
e_charts(x = date) |>
e_area_(serie = country_name[1]) |>
e_area_(serie = country_name[2], x_index = 1, y_index = 1)
runApp()
