}
df <- map_df(c("TR","BT"),read_cpi )
read_cpi <- function(country) {
Sys.sleep(sample(1:15,size = 1,replace = TRUE))
read_csv(paste0("https://www.econdb.com/api/series/CPI",country, "/?format=csv"),
show_col_types = FALSE) |>
mutate(country_abb = country) |>
rename(cpi = paste0("CPI",country)) |>
set_names(c("date", "cpi", "country_abb")) |>
mutate(date = as.Date(date),
cpi = as.double(cpi),
country_abb = as.character(country_abb))
}
df <- map_df(c("TR","BT"),possibly(read_cpi,otherwise = NULL) )
View(df)
df <- map_df(c("TR","US","BT"),possibly(read_cpi,otherwise = NULL) )
read_cpi <- function(country) {
Sys.sleep(sample(1:15,size = 1,replace = TRUE))
read_csv(paste0("https://www.econdb.com/api/series/CPI",country, "/?format=csv"),
show_col_types = FALSE) |>
mutate(country_abb = country) |>
rename(cpi = paste0("CPI",country)) |>
set_names(c("date", "cpi", "country_abb")) |>
mutate(date = as.Date(date),
cpi = as.double(cpi),
country_abb = as.character(country_abb))
}
df <- map_df(c("TR","US","BT"),possibly(read_cpi,otherwise = NULL) )
View(df)
df <- map_df(c("TR","US","BT", "FR"),possibly(read_cpi,otherwise = NULL) )
View(df)
df <- map_df(codes,possibly(read_cpi,otherwise = NULL) )
View(df)
object.size(df)
object.size(x = df, "mb")
object.size(df, "gb")
object.size(df)/1e-9
index <- c("CPI", "URATE", "RGFCF", "RPUC","RETA",
"IP", "RGDP","CONF","PPI","GDEBT","GDP",
"RPRC","HOU","UTIL","SENT","CBAL","PUC",
"PRC", "GFCF", "EXP", "RCI", "REXP","SEI",
"RIMP","IMP","POP","CI","GBAL","EMP","JVR",
"JQR","GDPPC","RGDPPC","GSPE","GREV","M3",
"CA","WAGEMAN","JLR","JHR","OILPROD","ELE")
index
unique(index)
# This file allows packrat (used by rsconnect during deployment) to pick up dependencies.
library(rhino)
library(tidyverse)
library(echarts4r)
library(naniar)
library(reactable)
library(htmlwidgets)
library(countrycode)
read_cpi
read_cpi <- function(country, index) {
Sys.sleep(sample(1:15,size = 1,replace = TRUE))
read_csv(paste0("https://www.econdb.com/api/series/",index,country, "/?format=csv"),
show_col_types = FALSE) |>
mutate(country_abb = country) |>
rename(cpi = paste0("CPI",country)) |>
set_names(c("date", "cpi", "country_abb")) |>
mutate(date = as.Date(date),
cpi = as.double(cpi),
country_abb = as.character(country_abb))
}
read_cpi(country = "TR",index = "CPI")
read_cpi <- function(country, index) {
Sys.sleep(sample(1:15,size = 1,replace = TRUE))
read_csv(paste0("https://www.econdb.com/api/series/",index,country, "/?format=csv"),
show_col_types = FALSE) |>
mutate(country_abb = country) |>
rename(index = paste0(index,country)) |>
set_names(c("date", "cpi", "country_abb")) |>
mutate(date = as.Date(date),
cpi = as.double(cpi),
country_abb = as.character(country_abb))
}
read_cpi(country = "TR",index = "CPI")
df <- map2_df(c("TR","US"),c("CPI","IP"),possibly(read_cpi,otherwise = NULL) )
View(df)
df <- map2_dfr(c("TR","US"),c("CPI","IP"),possibly(read_cpi,otherwise = NULL) )
df <- pmap_df(c("TR","US"),c("CPI","IP"),possibly(read_cpi,otherwise = NULL) )
index <- c("CPI", "URATE", "RGFCF", "RPUC","RETA",
"IP", "RGDP","CONF","PPI","GDEBT","GDP",
"RPRC","HOU","UTIL","SENT","CBAL","PUC",
"PRC", "GFCF", "EXP", "RCI", "REXP","SEI",
"RIMP","IMP","POP","CI","GBAL","EMP","JVR",
"JQR","GDPPC","RGDPPC","GSPE","GREV","M3",
"CA","WAGEMAN","JLR","JHR","OILPROD","ELE") |> as.list()
df <- pmap_df(list("TR","US"),list("CPI","IP"),possibly(read_cpi,otherwise = NULL) )
df <- map_df(list("TR","US"),map_df(list("CPI","IP"), possibly(read_cpi,otherwise = NULL)) )
df <- map_df(list("TR","US"),list("CPI","IP"),possibly(~read_cpi(.x,.y),otherwise = NULL) )
df <- map_df(list("TR","US"),list("CPI","IP"),possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
df <- map2_df(list("TR","US"),list("CPI","IP"),possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
View(df)
df <- map2_df(list("US"),list("IP"),possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
View(df)
read_cpi <- function(country, index) {
Sys.sleep(sample(1:15,size = 1,replace = TRUE))
read_csv(paste0("https://www.econdb.com/api/series/",index,country, "/?format=csv"),
show_col_types = FALSE) |>
mutate(country_abb = country) |>
rename(index = paste0(index,country)) |>
set_names(c("date", index, "country_abb")) |>
mutate(date = as.Date(date),
cpi = as.double(cpi),
country_abb = as.character(country_abb))
}
df <- map2_df(list("US"),list("IP"),possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
View(df)
df <- map2_df(list("US"),list("IP"),possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
read_cpi <- function(country, index) {
Sys.sleep(sample(1:15,size = 1,replace = TRUE))
read_csv(paste0("https://www.econdb.com/api/series/",index,country, "/?format=csv"),
show_col_types = FALSE) |>
mutate(country_abb = country) |>
rename(index = paste0(index,country)) |>
set_names(c("date", index, "country_abb"))
}
df <- map2_df(list("US"),list("IP"),possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
View(df)
df <- map2_df(list("US"),list("IP","CPI"),possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
View(df)
df <- map2_dfr(list("US"),list("IP","CPI"),possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
View(df)
df <- map2_dfr(list("US","TR"),list("IP","CPI"),possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
View(df)
df <- map2_dfr(codes,index,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
codes |> class()
codes |> str()
codes <- country_code |> pull(wb_api2c) |> as.list()
index <- c("CPI", "URATE", "RGFCF", "RPUC","RETA",
"IP", "RGDP","CONF","PPI","GDEBT","GDP",
"RPRC","HOU","UTIL","SENT","CBAL","PUC",
"PRC", "GFCF", "EXP", "RCI", "REXP","SEI",
"RIMP","IMP","POP","CI","GBAL","EMP","JVR",
"JQR","GDPPC","RGDPPC","GSPE","GREV","M3",
"CA","WAGEMAN","JLR","JHR","OILPROD","ELE") |> as.list()
df <- map2_dfr(codes,index,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
map(codes,index)
map_raw(codes, index)
for (i in index) {
df <- map2_dfr(codes,i,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
}
data <- for (i in index) {
df <- map2_dfr(codes,i,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
}
data <- for (i in index) {
df <- map2_dfr(codes,i,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
}
df <- for (i in index) {
df <- map2_dfr(codes,i,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
}
View(df)
for (i in index) {
df <- map2_dfr(codes,i,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
df <- bind_rows(df)
}
codes <- country_code |> pull(wb_api2c)
index <- c("CPI", "URATE", "RGFCF", "RPUC","RETA",
"IP", "RGDP","CONF","PPI","GDEBT","GDP",
"RPRC","HOU","UTIL","SENT","CBAL","PUC",
"PRC", "GFCF", "EXP", "RCI", "REXP","SEI",
"RIMP","IMP","POP","CI","GBAL","EMP","JVR",
"JQR","GDPPC","RGDPPC","GSPE","GREV","M3",
"CA","WAGEMAN","JLR","JHR","OILPROD","ELE")
lists <- expand.grid(codes,index)
lists
df <- map2_dfr(lists$Var1,lists$Var2,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
indexes <- c("CPI","CONF","IP","PPI","HOU","RGDPPC")
lists <- expand.grid(codes,indexes)
lists
lists |> str()
read_cpi <- function(country, index) {
Sys.sleep(sample(1:15,size = 1,replace = TRUE))
read_csv(paste0("https://www.econdb.com/api/series/",index,country, "/?format=csv"),
show_col_types = FALSE) |>
mutate(country_abb = country) |>
rename(index = paste0(index,country)) |>
set_names(c("date", index, "country_abb"))
}
df <- map2_dfr(lists$Var1,lists$Var2,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
library(rhino)
library(tidyverse)
library(echarts4r)
library(naniar)
library(reactable)
library(htmlwidgets)
library(countrycode)
df <- map2_dfr(lists$Var1,lists$Var2,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
#,"IP","PPI","HOU","RGDPPC"
indexes <- c("CPI","CONF")
lists <- expand.grid(codes,indexes)
read_cpi <- function(country, index) {
Sys.sleep(sample(1:15,size = 1,replace = TRUE))
read_csv(paste0("https://www.econdb.com/api/series/",index,country, "/?format=csv"),
show_col_types = FALSE) |>
mutate(country_abb = country) |>
rename(index = paste0(index,country)) |>
set_names(c("date", index, "country_abb"))
}
df <- map2_dfr(lists$Var1,lists$Var2,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
lists
read_cpi <- function(country, index) {
Sys.sleep(sample(1:10,size = 1,replace = TRUE))
read_csv(paste0("https://www.econdb.com/api/series/",index,country, "/?format=csv"),
show_col_types = FALSE) |>
mutate(country_abb = country) |>
rename(index = paste0(index,country)) |>
set_names(c("date", index, "country_abb"))
}
df <- map2_dfr(lists$Var1,lists$Var2,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
View(df)
read_cpi <- function(country, index) {
Sys.sleep(sample(1:10,size = 1,replace = TRUE))
read_csv(paste0("https://www.econdb.com/api/series/",index,country, "/?format=csv"),
show_col_types = FALSE) |>
mutate(country_abb = country) |>
rename(index = paste0(index,country)) |>
set_names(c("date", index, "country_abb")) |>
mutate(date = as.Date(date))
}
df <- map2_dfr(lists$Var1,lists$Var2,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
read_cpi <- function(country, index) {
Sys.sleep(sample(1:10,size = 1,replace = TRUE))
read_csv(paste0("https://www.econdb.com/api/series/",index,country, "/?format=csv"),
show_col_types = FALSE) |>
mutate(country_abb = country) |>
rename(index = paste0(index,country)) |>
set_names(c("date", index, "country_abb")) |>
mutate(date = as.Date(date), index = as.double(index), country_abb = as.character(country_abb))
}
df <- map2_dfr(lists$Var1,lists$Var2,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
df <- map2_df(lists$Var1,lists$Var2,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
list()
lists
df <- map2_dfr(c("TR","US"),c("CPI","CONF"),possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
View(df)
read_cpi <- function(country, index) {
Sys.sleep(sample(1:10,size = 1,replace = TRUE))
read_csv(paste0("https://www.econdb.com/api/series/",index,country, "/?format=csv"),
show_col_types = FALSE) |>
mutate(country_abb = country) |>
rename(index = paste0(index,country)) |>
set_names(c("date", index, "country_abb"))
}
df <- map2_dfr(c("TR","US"),c("CPI","CONF"),possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
View(df)
lists$Var1
c("TR","US")
lists$Var2
lists <- expand.grid(codes,indexes) |> as.character()
lists |> glimpse()
listst
lists
lists <- expand.grid(codes,indexes,stringsAsFactors = FALSE)
lists
df <- map2_dfr(lists$Var1,lists$Var2,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
read_cpi(country = "TR",index = "CPI")
read_cpi <- function(country, index) {
Sys.sleep(sample(1:10,size = 1,replace = TRUE))
read_csv(paste0("https://www.econdb.com/api/series/",index,country, "/?format=csv"),
show_col_types = FALSE, col_types = "Ddc") |>
mutate(country_abb = country) |>
rename(index = paste0(index,country)) |>
set_names(c("date", index, "country_abb"))
}
read_cpi(country = "TR","CI")
read_cpi <- function(country, index) {
Sys.sleep(sample(1:10,size = 1,replace = TRUE))
read_csv(paste0("https://www.econdb.com/api/series/",index,country, "/?format=csv"),
show_col_types = FALSE, col_types = "Ddc") |>
mutate(country_abb = country) |>
rename(index = paste0(index,country)) |>
set_names(c("date", index, "country_abb"))
}
df <- map2_dfr(lists$Var1,lists$Var2,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
View(df)
lists <- expand.grid(codes,index,stringsAsFactors = FALSE)
lists
read_cpi <- function(country, index) {
Sys.sleep(sample(1:10,size = 1,replace = TRUE))
read_csv(paste0("https://www.econdb.com/api/series/",index,country, "/?format=csv"),
show_col_types = FALSE, col_types = "Ddc") |>
mutate(country_abb = country) |>
rename(index = paste0(index,country)) |>
set_names(c("date", index, "country_abb"))
}
df <- map2_dfr(lists$Var1,lists$Var2,possibly(~read_cpi(country = .x,index = .y),otherwise = NULL) )
View(df)
library(rhino)
library(echarts4r)
library(naniar)
library(reactable)
library(htmlwidgets)
library(countrycode)
library(readr)
library(dplyr)
library(purrr)
View(df)
library(rhino)
library(echarts4r)
library(naniar)
library(reactable)
library(htmlwidgets)
library(countrycode)
library(readr)
library(dplyr)
library(purrr)
library(tidyr)
box::use(
countrycode::codelist_panel,
dplyr[select,distinct,pull,mutate,rename],
tidyr[drop_na],
readr[read_csv],
purr[set_names,map2_dfr]
)
df |>  glimpse()
df |>
filter(country_abb = "TR") |>
select(date,JLR, JHR)
df |>
filter(country_abb = "TR") |>
select(date,JLR, JHR)
df |>
filter(country_abb = ="TR") |>
df |>
filter(country_abb =="TR") |>
select(date,JLR, JHR)
df |>
filter(country_abb =="TR") |>
select(date,JLR, JHR) |>
drop_na()
df |>
filter(country_abb =="TR") |>
select(date,JLR, JHR) |>
drop_na()
df |>
filter(country_abb =="TR") |>
select(date,JVR, JQR) |>
drop_na()
df |>
filter(country_abb =="TR") |>
select(date,REXP, RIMP) |>
drop_na()
df |>
filter(country_abb =="TR") |>
select(date,EXP, IMP) |>
drop_na()
df |>
filter(country_abb =="TR") |>
select(date,CPI) |>
drop_na()
df |>
filter(country_abb =="TR") |>
select(date,CPI,CONF) |>
drop_na()
df |>
filter(country_abb =="TR") |>
select(date,CPI,PPI) |>
drop_na()
df |>
filter(country_abb =="TR") |>
select(date,CPI,CONF) |>
drop_na()
df |>
filter(country_abb =="TR") |>
select(date,CONF) |>
drop_na()
df |>
filter(country_abb =="TR") |>
select(date,CONF,CPI)
df |>
filter(country_abb =="TR") |>
select(date,CONF,CPI) |>
miss_var_summary()
df |>
filter(country_abb =="TR") |>
select(date,CONF,CPI) |>
View()
df |> View()
box::use(
countrycode::codelist_panel,
dplyr[select,distinct,pull,mutate,rename],
tidyr[drop_na],
readr[read_csv],
purr[set_names,map2_dfr]
)
box::use(
countrycode$codelist_panel,
dplyr[select,distinct,pull,mutate,rename],
tidyr[drop_na],
readr[read_csv],
purr[set_names,map2_dfr]
)
box::use(
countrycode$codelist_panel,
dplyr[select,distinct,pull,mutate,rename],
tidyr[drop_na],
readr[read_csv],
purr[set_names,map2_dfr]
)
box::use(
dplyr[select,distinct,pull,mutate,rename],
tidyr[drop_na],
readr[read_csv],
purr[set_names,map2_dfr]
)
box::use(
dplyr[select,distinct,pull,mutate,rename],
tidyr[drop_na],
readr[read_csv],
purr[set_names,map2_dfr]
)
box::use(
dplyr[select,distinct,pull,mutate,rename],
tidyr[drop_na],
readr[read_csv],
purrr[set_names,map2_dfr]
)
View(df)
df |>
select(date, country_abb) |>
distinct() |> View()
df |>
select(date, country_abb) |>
distinct() |>
left_join(df, by = c("date" = "date", "country_abb" = "country_abb")) |> View()
df |>
select(date, country_abb) |>
distinct() |>
left_join(df |> drop_na(), by = c("date" = "date", "country_abb" = "country_abb")) |> View()
df |>
select(date, country_abb) |>
distinct() |>
right_join(df |> drop_na(), by = c("date" = "date", "country_abb" = "country_abb")) |> View()
df |>
select(date, country_abb) |>
distinct() |>
left_join(df |> drop_na(), by = c("date" = "date", "country_abb" = "country_abb")) |> View()
df |> glimpse()
df |>
pivot_longer(!c(date, country_abb), names_to = "index",values_to = "rate")
df |>
pivot_longer(!c(date, country_abb), names_to = "index",values_to = "rate") |>
drop_na()
df <- df |>
pivot_longer(!c(date, country_abb), names_to = "index",values_to = "rate") |>
drop_na()
View(df)
data$df
d
data$df
box::use(
app/logic/data
)
box::use(
app/logic/data,
purrr$map2_dfr
)
box::use(
purrr$map2_dfr,
tidyr[drop_na, pivot_longer],
app/logic/functions
)
box::use(
purrr$map2_dfr,
tidyr[drop_na, pivot_longer],
dplyr[select,distinct,mutate,rename],
app/logic/functions
)
box::use(
purrr[map2_dfr],
tidyr[drop_na, pivot_longer],
dplyr[select,distinct,mutate,rename],
app/logic/functions
)
box::use(
app/logic/data,
purrr$map2_dfr
)
box::use(
app/logic/data
)
box::use(
app/logic/data
)
box::use(
app/logic/data
)
box::use(
app/logic/data
)
box::use(
purrr[map2_dfr],
tidyr[drop_na, pivot_longer],
dplyr[select,distinct,mutate,rename,pull],
app/logic/functions
)
box::use(
app/logic/data
)
box::use(
purrr[map2_dfr,possibly],
tidyr[drop_na, pivot_longer],
dplyr[select,distinct,mutate,rename,pull],
app/logic/functions
)
box::use(
app/logic/data
)
